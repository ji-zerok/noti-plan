# 광고성 알림 물량 관리 시스템

조직별 광고성 알림 발송 물량을 효율적으로 관리하는 웹 어드민 시스템입니다.

## 주요 기능

### 1. 관리자 기능
- 조직별 월간 발송 물량 설정
- 조직과 연월을 선택하여 총 물량 할당

### 2. 서비스 담당자 기능
- 조직 및 소속 서비스 선택
- 발송 날짜와 물량 신청
- 실시간 물량 초과 검증
- 남은 물량 확인

### 3. 현황 관리
- 달력 형태로 물량 현황 시각화
- 조직별 월간 물량 요약 (총 물량, 신청 물량, 남은 물량)
- 일별 서비스별 발송 물량 상세 확인
- 진행률 표시

## 시스템 구조

### 데이터베이스 모델
- **Organization**: 조직 정보
- **Service**: 서비스 정보 (조직 소속)
- **MonthlyQuota**: 조직별 월간 물량
- **SendRequest**: 발송 물량 신청

## 설치 및 실행

### 1. 가상환경 활성화
```bash
source .venv/bin/activate  # macOS/Linux
# 또는
.venv\Scripts\activate  # Windows
```

### 2. 패키지 설치
```bash
pip install -r requirements.txt
```

### 3. 초기 데이터 생성
```bash
# 서버 실행 후 브라우저에서 접속
python app.py

# 그 다음 브라우저에서 다음 URL 접속하여 샘플 데이터 생성
http://localhost:5000/init
```

### 4. 애플리케이션 접속
- 관리자 페이지: http://localhost:5000/admin
- 물량 신청 페이지: http://localhost:5000/request
- 현황 보기 페이지: http://localhost:5000/calendar

## 사용 방법

### 관리자
1. `/admin` 페이지 접속
2. 조직 선택
3. 연월 선택 (기본값: 다음 달)
4. 총 물량 입력
5. "물량 설정" 버튼 클릭

### 서비스 담당자
1. `/request` 페이지 접속
2. 조직 선택
3. 서비스 선택 (자동으로 해당 조직의 서비스 목록 로드)
4. 발송 날짜 선택
5. 발송 물량 입력
6. 실시간으로 남은 물량 확인
7. "신청하기" 버튼 클릭

### 현황 확인
1. `/calendar` 페이지 접속
2. 조직 선택
3. 월 이동 버튼으로 원하는 월 조회
4. 달력에서 일별 물량 확인
5. 상단 요약 정보로 전체 현황 파악

## 핵심 기능 설명

### 물량 초과 방지
- 서비스 담당자가 물량을 신청할 때, 해당 월의 조직 총 물량을 자동으로 검증
- 남은 물량을 초과하는 신청은 자동으로 거부
- 실시간으로 남은 물량 표시

### 달력 시각화
- 일별로 서비스별 발송 물량 표시
- 하루 총 발송 물량 합계 표시
- 주말 구분 표시
- 조직별 월간 진행률 표시 (바 그래프)

## 샘플 데이터

초기 데이터 생성 시 다음과 같은 샘플 데이터가 생성됩니다:

**조직**
- 대출
- 카드

**서비스**
- 신용대출 (대출 조직, 담당자: 김철수)
- 주택담보대출 (대출 조직, 담당자: 이영희)
- 신용점수 (대출 조직, 담당자: 박민수)
- 신용카드 (카드 조직, 담당자: 최지은)
- 체크카드 (카드 조직, 담당자: 정수진)

## 기술 스택

- **Backend**: Python Flask
- **Database**: SQLite (SQLAlchemy ORM)
- **Frontend**: HTML, CSS, Vanilla JavaScript
- **UI**: 반응형 웹 디자인

## 파일 구조

```
noti_plan/
├── app.py                 # Flask 애플리케이션 메인
├── requirements.txt       # Python 패키지 의존성
├── templates/            # HTML 템플릿
│   ├── admin.html        # 관리자 페이지
│   ├── request.html      # 물량 신청 페이지
│   └── calendar.html     # 현황 보기 페이지
├── static/               # 정적 파일
│   └── css/
│       └── style.css     # 스타일시트
└── noti_plan.db          # SQLite 데이터베이스 (실행 후 생성)
```

## API 엔드포인트

- `POST /api/quota` - 조직 물량 설정
- `GET /api/quota/<org_id>/<year_month>` - 물량 조회
- `GET /api/services/<org_id>` - 조직의 서비스 목록
- `POST /api/request` - 물량 신청
- `GET /api/calendar/<org_id>/<year_month>` - 달력 데이터 조회

## 향후 개선 사항

- [ ] 사용자 인증 및 권한 관리
- [ ] 물량 신청 승인/거부 워크플로우
- [ ] 물량 신청 이력 조회
- [ ] 엑셀 다운로드 기능
- [ ] 알림 기능 (물량 초과 임박 시)
- [ ] 대시보드 추가